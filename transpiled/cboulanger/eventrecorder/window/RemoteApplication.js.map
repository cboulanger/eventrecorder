{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/eventrecorder/source/class/cboulanger/eventrecorder/window/RemoteApplication.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "include",
    "cboulanger",
    "eventrecorder",
    "window",
    "MRemoteBinding",
    "construct",
    "uri",
    "config",
    "url",
    "_computeApplicationUrl",
    "window_name",
    "createUuid",
    "_computeWindowConfig",
    "__window",
    "bom",
    "Window",
    "open",
    "addEventListener",
    "isClosed",
    "close",
    "members",
    "defaultConfig",
    "_getWindowDefaultConfig",
    "key",
    "undefined",
    "_getWindow",
    "width",
    "height",
    "dependent",
    "menubar",
    "status",
    "scrollbars",
    "toolbar",
    "startsWith",
    "appUrl",
    "util",
    "Uri",
    "parseUri",
    "location",
    "href",
    "parentDir",
    "protocol",
    "authority",
    "directory",
    "split",
    "slice",
    "join",
    "focus",
    "destruct",
    "RemoteApplication"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2018 The authors\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Christian Boulanger (cboulanger)\n\n************************************************************************ */\n\n/**\n * A proxy for an application running in a different browser window or tab\n *\n */\nqx.Class.define(\"cboulanger.eventrecorder.window.RemoteApplication\", {\n  extend: qx.core.Object,\n  include: [cboulanger.eventrecorder.window.MRemoteBinding],\n\n  /**\n   * Constructor\n   * @param uri {String}\n   * @param config {Object}\n   */\n  construct: function(uri, config) {\n    this.base(arguments);\n    var url = this._computeApplicationUrl(uri);\n    var window_name = \"window-\" + this.createUuid();\n    config = this._computeWindowConfig(config);\n    this.__window = qx.bom.Window.open(url, window_name, config);\n    window.addEventListener(\"beforeunload\", () => {\n      if (!this.isClosed()) {\n        this.close();\n      }\n      this.__window = null;\n    });\n  },\n  members: {\n    __window: null,\n\n    /**\n     * Returns the map that is passed into {@link qx.bom.Window#open}, using\n     * default values and overriding them with values in the map.\n     * @param config {Object|undefined}\n     * @return {Object}\n     */\n    _computeWindowConfig(config={}) {\n      var defaultConfig = this._getWindowDefaultConfig();\n      for (var key in defaultConfig) {\n        if (config[key] === undefined) {\n          config[key] = defaultConfig[key];\n        }\n      }\n      return config;\n    },\n\n    /**\n     * Exposes the internal window object\n     * @return {Window}\n     */\n    _getWindow: function() {\n      return this.__window;\n    },\n\n    /**\n     * Returns default values for {@link qx.bom.Window#open}. Can be overridden\n     * to set other values.\n     * @return {Object}\n     */\n    _getWindowDefaultConfig() {\n      return {\n        width: 800,\n        height: 600,\n        dependent: true,\n        menubar: false,\n        status: false,\n        scrollbars: false,\n        toolbar: false\n      };\n    },\n\n    /**\n     * Given an identifier (either a complete URL or an application name as stated\n     * in compile.json), return the URL to the application.\n     * @param uri\n     * @return {String}\n     * @private\n     */\n    _computeApplicationUrl(uri) {\n      if (!uri.startsWith(\"http\")) {\n        // if this isn't a valid URL, prepend parente directory\n        var appUrl = qx.util.Uri.parseUri(location.href);\n        var parentDir = appUrl.protocol + \"://\" + appUrl.authority + appUrl.directory.split(\"/\").slice(0, -2).join(\"/\");\n        uri = parentDir + \"/\" + uri;\n      }\n      return uri;\n    },\n\n    open: function() {\n      this.__window.focus();\n    },\n\n    close: function () {\n      this.__window.close();\n    },\n\n    isClosed: function () {\n      return qx.bom.Window.isClosed(this.__window);\n    }\n\n  },\n\n  destruct: function () {\n    this.base(arguments);\n    if (!qx.bom.Window.isClosed(this.__window)) {\n      this.__window.close();\n    }\n    this.__window = null;\n  }\n});\n"
  ]
}