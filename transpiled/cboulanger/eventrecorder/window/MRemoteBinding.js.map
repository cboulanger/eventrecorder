{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/eventrecorder/source/class/cboulanger/eventrecorder/window/MRemoteBinding.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Mixin",
    "define",
    "statics",
    "SERIALIZER_CLASS_PROP",
    "SERIALIZER_DATA_PROP",
    "construct",
    "__remoteWindows",
    "window",
    "opener",
    "name",
    "members",
    "__changeSource",
    "__isInitialized",
    "syncProperties",
    "win",
    "remoteWindow",
    "cboulanger",
    "eventrecorder",
    "RemoteApplication",
    "_getWindow",
    "__sendReadyEvent",
    "Error",
    "__initialize",
    "push",
    "createUuid",
    "dt",
    "Date",
    "getTime",
    "uuid",
    "replace",
    "c",
    "r",
    "Math",
    "random",
    "floor",
    "toString",
    "_getPropertyNamesToSync",
    "Class",
    "getProperties",
    "getByName",
    "classname",
    "filter",
    "prop",
    "startsWith",
    "properties",
    "info",
    "join",
    "forEach",
    "firstUpProp",
    "lang",
    "String",
    "firstUp",
    "eventName",
    "attachChangeBubbleListener",
    "value",
    "core",
    "Object",
    "__remoteBindingChangeBubbleListenerId",
    "supportsEvent",
    "constructor",
    "console",
    "debug",
    "id",
    "addListener",
    "e",
    "__handleLocalChangeBubbleEvent",
    "bind",
    "getData",
    "__handleLocalPropertyChangeEvent",
    "that",
    "addEventListener",
    "message",
    "__handleIncomingMessage",
    "type",
    "getType",
    "oldValue",
    "getOldData",
    "data",
    "__serialize",
    "oldData",
    "__broadcastEvent",
    "__computePropertyNameFromEventType",
    "slice",
    "firstLow",
    "Type",
    "isArray",
    "map",
    "old",
    "item",
    "__sendEventMessage",
    "Assert",
    "assertTrue",
    "isString",
    "event",
    "undefined",
    "__sendMessage",
    "bom",
    "Window",
    "isClosed",
    "postMessage",
    "indexOf",
    "source",
    "warn",
    "msgData",
    "isObject",
    "__handleRemotePropertyChangeEvent",
    "__handleRemoteReadyEvent",
    "__handleRemoteChangeBubbleEvent",
    "evtData",
    "__unserialize",
    "target",
    "parts",
    "split",
    "part",
    "getItem",
    "parseInt",
    "lastPart",
    "pop",
    "match",
    "range",
    "start",
    "deleteCount",
    "length",
    "args",
    "concat",
    "splice",
    "apply",
    "serialize",
    "object",
    "util",
    "Serializer",
    "toNativeObject",
    "class_prop",
    "data_prop",
    "result",
    "hasInterface",
    "IListData",
    "i",
    "getLength",
    "PropertyUtil",
    "getAllProperties",
    "group",
    "unserialize",
    "includeBubbleEvents",
    "marshal",
    "Json",
    "createModel",
    "Clazz",
    "index",
    "setItem",
    "set",
    "MRemoteBinding"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2018 The authors\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Christian Boulanger (cboulanger)\n\n************************************************************************ */\n\n/**\n * A mixin providing methods for binding properties between applications\n * running in separate browser windows\n */\nqx.Mixin.define(\"cboulanger.eventrecorder.window.MRemoteBinding\", {\n\n  statics: {\n    SERIALIZER_CLASS_PROP: \"$$class\",\n    SERIALIZER_DATA_PROP: \"$$data\"\n  },\n\n  construct: function() {\n    this.__remoteWindows = [];\n    if (!window.opener && !window.name) {\n      window.name = \"Main application\";\n    }\n  },\n\n  members: {\n\n    __changeSource: null,\n    __remoteWindows: null,\n    __isInitialized: false,\n\n    /**\n     * Initializes property synchronization with the remote window\n     * @param win {Window|cboulanger.eventrecorder.window.RemoteApplication}\n     */\n    syncProperties: function(win) {\n      var remoteWindow;\n      if (win instanceof cboulanger.eventrecorder.window.RemoteApplication) {\n        remoteWindow = win._getWindow();\n      } else if (win.window === win) {\n        remoteWindow = win;\n        if (win === window.opener) {\n          // send ready message to opener\n          this.__sendReadyEvent(win);\n        }\n      } else {\n        throw new Error(\"Argument must be a Window or RemoteApplication object, is \" + win);\n      }\n\n      if (!this.__isInitialized) {\n        this.__initialize();\n      }\n      // keep a reference to the window\n      this.__remoteWindows.push(remoteWindow);\n    },\n\n    /**\n     * Create a pseudo-UUID to avoid name clashes\n     * @return {string}\n     */\n    createUuid: function() {\n      var dt = new Date().getTime();\n      var uuid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\n        var r = (dt + Math.random()*16)%16 | 0;\n        dt = Math.floor(dt/16);\n        return (c === \"x\" ? r :(r&0x3|0x8)).toString(16);\n      });\n      return uuid;\n    },\n\n    /**\n     * Returns an array with all the property names to synchronize. Override\n     * to refine behavior.\n     * @return {Array}\n     */\n    _getPropertyNamesToSync: function() {\n      return qx.Class.getProperties(qx.Class.getByName(this.classname))\n        .filter(function(prop) {\n          return !prop.startsWith(\"qx\");\n        });\n    },\n\n    __initialize: function() {\n      var properties = this._getPropertyNamesToSync();\n      this.info(\"Initializing remote binding with properties \" + properties.join(\", \"));\n      properties.forEach(function(prop) {\n        var firstUpProp = qx.lang.String.firstUp(prop);\n        var eventName = \"change\" + firstUpProp;\n        var attachChangeBubbleListener = function(value) {\n          if (value instanceof qx.core.Object && !value.__remoteBindingChangeBubbleListenerId) {\n            if (qx.Class.supportsEvent(value.constructor, \"changeBubble\")) {\n              console.debug(\"Attaching bubble event listener on \" + prop);\n              var id = value.addListener(\"changeBubble\", function(e) {\n                this.__handleLocalChangeBubbleEvent(e, prop);\n              }, this);\n              value.__remoteBindingChangeBubbleListenerId = id;\n            }\n          }\n        }.bind(this);\n        // watch for bubble events on existing suitable properties\n        attachChangeBubbleListener(this[\"get\" + firstUpProp]());\n        // watch for property changes\n        if (qx.Class.supportsEvent(this.constructor, eventName)) {\n          this.addListener(eventName, function(e) {\n            attachChangeBubbleListener(e.getData());\n            this.__handleLocalPropertyChangeEvent(e);\n          }, this);\n        }\n      }, this);\n      var that = this;\n      window.addEventListener(\"message\", function(message) {\n        that.__handleIncomingMessage(message);\n      });\n      this.__isInitialized = true;\n    },\n\n    /**\n     * Handles the property change events of the instance\n     * @param e {qx.event.type.Data}\n     * @private\n     */\n    __handleLocalPropertyChangeEvent: function(e) {\n      var type = e.getType();\n      var value = e.getData();\n      var oldValue = e.getOldData();\n      var data = this.__serialize(value);\n      var oldData = this.__serialize(oldValue);\n      this.__broadcastEvent(type, data, oldData);\n    },\n\n    /**\n     * Given a property change event name, return the name of the property\n     * @param type {String}\n     * @return {String}\n     * @private\n     */\n    __computePropertyNameFromEventType: function(type) {\n      var firstUpProp = type.slice(6);\n      return qx.lang.String.firstLow(firstUpProp);\n    },\n\n    /**\n     * Broadcasts the 'changeBubble' events of the instance properties\n     * @param e {qx.event.type.Data}\n     * @param prop {String} the name of the property that fired the event\n     * @private\n     */\n    __handleLocalChangeBubbleEvent: function(e, prop) {\n      var data = e.getData();\n      data.name = prop + \".\" + data.name;\n      if (qx.lang.Type.isArray(data.value)) {\n        data.value = data.value.map(this.__serialize, this);\n      } else {\n        data.value = this.__serialize(data.value);\n      }\n      delete data.old;\n      delete data.item;\n      this.__broadcastEvent(\"changeBubble\", data);\n    },\n\n    /**\n     * Broadcast a message with the given parameters\n     * @param type {String}\n     * @param data {*|undefined}\n     * @param oldData {*|undefined}\n     * @private\n     */\n    __broadcastEvent: function(type, data, oldData) {\n      this.__remoteWindows.forEach(function(win) {\n        if (win === this.__changeSource) {\n          // do not retransmit value change to origin of change\n          return;\n        }\n        this.__sendEventMessage(win, type, data, oldData);\n      }, this);\n    },\n\n    /**\n     * Sends a event message to the given window.\n     * @param win {Window}\n     * @param type {String}\n     * @param data {*|undefined}\n     * @param oldData {*|undefined}\n     * @private\n     */\n    __sendEventMessage: function(win, type, data, oldData) {\n      qx.core.Assert.assertTrue(type && qx.lang.Type.isString(type), \"Type must be a non-empty string\");\n      var message = {\n        event: {\n          type: type\n        }\n      };\n      if (data !== undefined) {\n        message.event.data = data;\n      }\n      if (oldData !== undefined) {\n        message.event.oldData = oldData;\n      }\n      this.__sendMessage(win, message);\n    },\n\n    /**\n     * Send a message to the peer using the postMessage API\n     * @param win {Window}\n     * @param message {String}\n     * @private\n     */\n    __sendMessage: function(win, message) {\n      qx.core.Assert.assertTrue(win.window === win, \"First argument must be a Window object\");\n      if (qx.bom.Window.isClosed(win)) {\n        // don't send messages to closed windows\n        return;\n      }\n      win.postMessage(message, \"*\");\n      console.debug(\">>> Message sent to \" + win.name) + \":\";\n      console.debug(message);\n    },\n\n    /**\n     * If the incoming message is a property change event sent by the peer,\n     * apply the new value\n     * @param message {Object}\n     * @private\n     */\n    __handleIncomingMessage: function(message) {\n      if (this.__remoteWindows.indexOf(message.source) < 0) {\n        this.warn(\"Ignoring message from unknown source...\");\n        return;\n      }\n      var msgData = message.data;\n      console.debug(\">>> Message received from \" + message.source.name + \":\");\n      console.debug(msgData);\n      if (!qx.lang.Type.isObject(msgData) || !msgData.event || !msgData.event.type) {\n        this.warn(\"Invalid message\");\n        return;\n      }\n      var type = msgData.event.type;\n      if (type.startsWith(\"change\") && type !== \"changeBubble\") {\n        this.__handleRemotePropertyChangeEvent(message);\n      } else {\n        switch (type) {\n          case \"ready\":\n            this.__handleRemoteReadyEvent(message);\n            break;\n          case \"changeBubble\":\n            this.__handleRemoteChangeBubbleEvent(message);\n            break;\n          default:\n            throw new Error(\"No handler for event type '\" + type + \"'.\");\n        }\n      }\n    },\n\n    /**\n     * When receiving the \"ready\" event from a window, send property state\n     * @param message {Object}\n     */\n    __handleRemoteReadyEvent: function(message) {\n      var win = message.source;\n      this._getPropertyNamesToSync().forEach(function(prop) {\n        var firstUpProp = qx.lang.String.firstUp(prop);\n        var type = \"change\" + firstUpProp;\n        var value = this[\"get\" + firstUpProp]();\n        var data = this.__serialize(value);\n        this.__sendEventMessage(win, type, data);\n      }, this);\n    },\n\n    /**\n     * Send the ready event to another window, usually the opener\n     * @param win {Window}\n     * @private\n     */\n    __sendReadyEvent: function(win) {\n      this.__sendEventMessage(win, \"ready\");\n    },\n\n    /**\n     * Handle the change event for normal property values\n     * @param message {Object}\n     * @private\n     */\n    __handleRemotePropertyChangeEvent: function(message) {\n      var evtData = message.data.event;\n      var firstUpProp = evtData.type.slice(6);\n      var prop = qx.lang.String.firstLow(firstUpProp);\n      var oldValue = this[\"get\" + firstUpProp]();\n      if (evtData.oldData !== undefined &&\n        !qx.lang.Type.isObject(evtData.oldData) &&\n        evtData.oldData !== oldValue) {\n        this.warn(\"Property '\" + prop + \"' was out of sync - remote old value \" + evtData.oldData + \" does not match \" + oldValue);\n      }\n      var data = evtData.data;\n      var value = this.__unserialize(data);\n      console.debug(\">>> Setting property '\" + prop + \"':\");\n      console.debug(value);\n      this.__changeSource = message.source;\n      this[\"set\" + firstUpProp](value);\n      this.__changeSource = null;\n    },\n\n    /**\n     * Handle the changeBubble event for qooxdoo data objects\n     * @param message {Object}\n     * @private\n     */\n    __handleRemoteChangeBubbleEvent: function(message) {\n      var evtData = message.data.event;\n      var target = this;\n      var parts = evtData.data.name.split(\".\");\n      var value = this.__unserialize(evtData.data.value);\n      parts.slice(0, -1).forEach(function(part) {\n        if (part[0] === \"[\") {\n          target = target.getItem(parseInt(part.slice(1, -1)));\n        } else {\n          target = target[\"get\" + qx.lang.String.firstUp(part)]();\n        }\n      });\n      var lastPart = parts.pop();\n      this.__changeSource = message.source; // prevent re-transmission of changed values\n      if (lastPart.match(/^[0-9]/)) {\n        var range = lastPart.split(\"-\");\n        var start = parseInt(range[0]);\n        var deleteCount;\n        if (range.length > 1) {\n          deleteCount = (range[1] - range[0])+1;\n        } else {\n          deleteCount = value.length-1;\n        }\n        var args = [start, deleteCount].concat(value);\n        target.splice.apply(target, args);\n      } else {\n        target[\"set\" + qx.lang.String.firstUp(lastPart)](value);\n      }\n      this.__changeSource = null;\n    },\n\n\n    /**\n     * Serialize an arbitrary value, including many qooxdoo objects,\n     * to a JSON value that can be sent to a remote target\n     * @param object {qx.core.Object|*}\n     * @return {*|Array|String|Object}\n     * @private\n     */\n    __serialize: function serialize(object) {\n      if (!(object instanceof qx.core.Object)) {\n        return qx.util.Serializer.toNativeObject(object);\n      }\n      var class_prop = this.self(arguments).SERIALIZER_CLASS_PROP;\n      var data_prop = this.self(arguments).SERIALIZER_DATA_PROP;\n      var classname;\n      if (object.classname.startsWith(\"qx.data.model.\")) {\n        classname = \"qx.data.model\";\n      } else {\n        classname = object.classname;\n      }\n      var result = {};\n      result[class_prop] = classname;\n      if (qx.Class.hasInterface(object.constructor, qx.data.IListData)) {\n        var data = [];\n        for (var i = 0; i < object.getLength(); i++) {\n          data.push(serialize(object.getItem(i)));\n        }\n        result[data_prop] = data;\n        return result;\n      }\n      var properties = qx.util.PropertyUtil.getAllProperties(object.constructor);\n      for (var name in properties) {\n        // ignore property groups\n        if (properties[name].group !== undefined) {\n          continue;\n        }\n        var value = object[\"get\" + qx.lang.String.firstUp(name)]();\n        result[name] = serialize(value);\n      }\n      return result;\n    },\n\n    /**\n     * Unserialize a JSON object, creating suitable qooxdoo objects from the\n     * metadata in the JSON\n     * @param object {Object|Array|*}\n     *    The json object which will be unserialized into a qooxdoo object if\n     *    it has been serialized from a qooxdoo object. Normal object and\n     *    primitive values will be used as-is.\n     * @param includeBubbleEvents {Boolean} Defaults to true\n     * @return {qx.core.Object|*}\n     */\n    __unserialize: function unserialize(object, includeBubbleEvents=true) {\n      var class_prop = this.self(arguments).SERIALIZER_CLASS_PROP;\n      var data_prop = this.self(arguments).SERIALIZER_DATA_PROP;\n      var result;\n      var prop;\n      if (qx.lang.Type.isArray(object)) {\n        return object.map(unserialize);\n      }\n      if (!qx.lang.Type.isObject(object)) {\n        return object;\n      }\n      var classname = object[class_prop];\n      if (classname) {\n        switch (classname) {\n          case \"qx.data.model\":\n            delete object[class_prop];\n            return qx.data.marshal.Json.createModel(object, includeBubbleEvents);\n          default:\n            var Clazz = qx.Class.getByName(classname);\n            result = new Clazz();\n            if (qx.Class.hasInterface(result.constructor, qx.data.IListData)) {\n              object[data_prop].forEach(function(item, index) {\n                result.setItem(index, unserialize(item));\n              });\n            } else {\n              for (prop in object) {\n                if (prop !== class_prop) {\n                  result.set(prop, unserialize(object[prop]));\n                }\n              }\n            }\n        }\n        return result;\n      }\n      for (prop in object) {\n        result[prop] = unserialize(object[prop]);\n      }\n      return result;\n    }\n  }\n});\n\n"
  ]
}